<div class="min-h-screen bg-gray-50">
  <app-header [user]="user" (logout)="logout()"></app-header>

  <main class="max-w-7xl mx-auto px-4 py-8">
    <div *ngIf="loading" class="text-center py-12">
      <p class="text-gray-600">Chargement...</p>
    </div>

    <div *ngIf="!loading" class="space-y-8">
      <!-- Add Transaction Form -->
      <app-add-transaction-form
        (success)="onTransactionAdded()"
      ></app-add-transaction-form>

      <!-- Edit Transaction Modal -->
      <div *ngIf="editingTransaction" class="fixed inset-0 z-50 flex items-center justify-center">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" (click)="onEditCancel()"></div>
        <div class="relative w-full max-w-2xl mx-4">
          <app-add-transaction-form
            [editingTransaction]="editingTransaction"
            (success)="onEditSuccess()"
            (cancel)="onEditCancel()"
          ></app-add-transaction-form>
        </div>
      </div>

      <!-- Stats -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <app-stats
          title="Total Recettes"
          [amount]="totalRecettes"
          icon="trend-up"
          color="success"
        ></app-stats>
        <app-stats
          title="Total Dépenses"
          [amount]="totalDepenses"
          icon="trend-down"
          color="danger"
        ></app-stats>
      </div>

      <!-- Solde -->
      <div class="bg-blue-500 text-white rounded-lg shadow-md p-6">
        <p class="text-lg font-semibold">Solde Actuel: {{ solde | number: '1.2-2' }} €</p>
      </div>

      <!-- Chart -->
      <app-chart [transactions]="transactions" [categories]="categories"></app-chart>

      <!-- Transactions -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <app-transaction-table
          title="Dernières Recettes"
          [transactions]="recettes"
          [categories]="categories"
          (delete)="onDeleteTransaction($event)"
          (edit)="onEditTransaction($event)"
        ></app-transaction-table>
        <app-transaction-table
          title="Dernières Dépenses"
          [transactions]="depenses"
          [categories]="categories"
          (delete)="onDeleteTransaction($event)"
          (edit)="onEditTransaction($event)"
        ></app-transaction-table>
      </div>
    </div>
  </main>
</div>
